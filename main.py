import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_classification, make_circles, make_blobs, make_moons
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from matplotlib.colors import ListedColormap
from mlxtend.plotting import plot_decision_regions

st.image(r"data:image/png;base64,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", width=700)

st.title('Classifier Boundary Visualization')
st.sidebar.header('Dataset Selection')
dataset_type = st.sidebar.selectbox('Choose Dataset', ['Classification', 'Circles', 'Blobs', 'Moons'])


if dataset_type == 'Classification':
    X, y = make_classification(n_samples=1000, n_features=2, n_redundant=0, n_clusters_per_class=1, class_sep=1, random_state=27)
elif dataset_type == 'Circles':
    X, y = make_circles(n_samples=1000, factor=0.5, noise=0.05)
elif dataset_type == 'Blobs':
    X, y = make_blobs(n_samples=2500, centers=2, n_features=2, cluster_std=1.0, random_state=27)
elif dataset_type == 'Moons':
    X, y = make_moons(n_samples=2500, noise=0.1, random_state=27)

st.sidebar.header('Classifier Selection')
classifier_type = st.sidebar.selectbox('Choose Classifier', ['KNN', 'Logistic Regression', 'Decision Tree'])

if classifier_type == 'KNN':
    n_neighbors = st.sidebar.slider('Neighbors (K)', 1, 15)  
    classifier = KNeighborsClassifier(n_neighbors=n_neighbors)
elif classifier_type == 'Logistic Regression':
    classifier = LogisticRegression()
elif classifier_type == 'Decision Tree':
    classifier = DecisionTreeClassifier()

classifier.fit(X, y)

x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1
y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1
xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.02), np.arange(y_min, y_max, 0.02))
Z = classifier.predict(np.c_[xx.ravel(), yy.ravel()])
Z = Z.reshape(xx.shape)

cmap_light = ListedColormap(['#ADD8E6', '#FFA07A'])
cmap_bold = ListedColormap(['#00008B', '#8B0000'])

fig, ax = plt.subplots()
ax.contourf(xx, yy, Z, alpha=0.4, cmap=cmap_light)
ax.scatter(X[:, 0], X[:, 1], c=y, cmap=cmap_bold, s=20, edgecolor='k')
ax.set_xlim(xx.min(), xx.max())
ax.set_ylim(yy.min(), yy.max())
ax.set_title(f'Decision Boundary ({classifier_type})')

st.pyplot(fig)


st.subheader('Dataset Details')
st.write(f'Dataset: {dataset_type}')
st.write(f'Number of samples: {len(X)}')
st.write(f'Number of features: {X.shape[1]}')


st.subheader('Classifier Details')
st.write(f'Classifier: {classifier_type}')
if classifier_type == 'KNN':
    st.write(f'Neighbors (K): {n_neighbors}')
